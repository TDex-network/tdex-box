version: "3.7"

services:
  tdexd:
    container_name: "tdexd"
    image: ghcr.io/tdex-network/tdexd:latest
    restart: unless-stopped
    environment:
      - TDEX_SSL_CERT=./cert.pem
      - TDEX_SSL_KEY=./key.pem
    ports:
      - "9945:9945"
      - "9000:9000"
    volumes:
      - ${TDEX_PATH}:/.tdex-daemon
      - ${SSL_CERT_PATH}:/cert.pem
      - ${SSL_KEY_PATH}:/key.pem
  tdexd-init:
    container_name: "tdexd-initializer"
    environment: 
      - WALLET_PASSWORD
    image: ghcr.io/tdex-network/tdexd:latest
    restart: unless-stopped
    command: bash -c "tdex config init && tdex config set rpcserver tdexd:9000 && tdex unlock --password ${WALLET_PASSWORD}"
    depends_on:
     - tdexd
  feederd:
    container_name: "feederd"
    image: ghcr.io/tdex-network/feederd:latest
    restart: unless-stopped
    volumes:
      - ${CONFIG_PATH}:/data/config.json
    depends_on: 
      - tdexd
